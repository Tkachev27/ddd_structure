import { Meta, Source } from '@storybook/addon-docs';
import dedent from 'ts-dedent';

<Meta title="Guards/TabsGuard"/>

## Description
Guard перенаправляет на первый доступный таб, необходимый для предотвращения перехода на url-ы с пустым контентом:
* /auto-provisioning
* /settings
* /network/device/:id
* /network/:id

## Usage
Импортировать в роутинг модуль необходимые объекты:
<Source
  language='js'
  dark
  format={true}
  code={dedent`
    import { RESOURCES } from 'src/app/shared/ory-auth/availability.service';
    import { TabsGuard } from 'src/app/shared/guards/tabs.guard';
    import { redirectConfigDefault } from 'src/app/shared/guards/redirect-config-default';
  `}
/>

Создать в роутинг модуле конфигурацию, в которой объявить дочерние роуты и ресурс, соответствующий роуту, на который мы хотим предотвратить переход:
<Source
  language='js'
  dark
  format={true}
  code={dedent`
    const redirectConfig = {
      childRoutes: childRoutes,
      preventedUrlResource: RESOURCES.DHCP
    }
  `}
/>

Добавить провайдер в роутинг модуль:
<Source
  language='js'
  dark
  format={true}
  code={dedent`
    providers: [
      TabsGuard,
      {
        provide: redirectConfigDefault,
        useValue: redirectConfig
      },
    ]
  `}
/>

Добавить дочерние роуты и активировать guard:
<Source
  language='js'
  dark
  format={true}
  code={dedent`
    const routes: Routes = [{
      path: '',
      component: SettingsComponent,
      canActivate: [TabsGuard],
      runGuardsAndResolvers: 'always',
      children: childRoutes,
    }];
  `}
/>
